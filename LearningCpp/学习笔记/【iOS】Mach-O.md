[TOC]



### Mach-O的基本结构？

### 常用的 Load commands ？

### 符号是如何完成重定位的？

### 各个Section都存放什么内容？

### Stub是什么？桩代码是什么？

### 加载Mach-O的流程，源码？

### 内存保护是什么意思，做什么的？如 segment_command_64 中的 maxprot

### 虚拟地址空间

https://www.jianshu.com/p/b6356e0ec63c

### 32位操作系统如何计算内存空间？

1. 内存的一个存储单元是 一个字节（也就是8位），而不是一位。
2. 内存的每一个字节都必须有一个地址，这样才能根据这个地址找到对应的内存（类似于门牌号）
3. 所谓32位系统是指的寻址范围，一共可以表示2^32个地址，对应的就是2^32个存储单元，也即2^32个字节的内存。**再强调一次：一个地址对应的是一个字节的内存！**
4. 综上，32位系统最大能支持的内存为：2^32/2^10/2^10/2^10=2^2=4GB

32位表示32个开关，32个开关则有 `4294967296` 种可能（4294967296个地址）
内存换算：1G = 1024M = 1024 * 1024KB = 1024 * 1024 * 1024Byte = 1073741824 Byte
内存 = 4294967296 种可能 / 1073741824Byte = 4GB

参考：

https://www.jianshu.com/p/5a44f69466cc



### 静态链接和动态链接的不同？

https://www.jianshu.com/p/c4b803c38d9a

库用于模块拆分，多个模块组成一个程序。

根据模块链接的时机或者方式，可以分为静态库和动态库

**静态库：**

Windows下的 .lib  Unix下的 .a, Mac 下的 .a 、.framework

静态库在链接的阶段会被完整地拷贝到可执行文件中，最终会是可执行文件的体积增大。

如果有多个可执行文件，则会有多个该静态库的冗余拷贝。

如果要更新静态库的内容，则需要把所有包含这个静态库的可执行文件重新编译生成一次。

**动态库：**

与静态库相反，动态库在编译和链接阶段不会被拷贝到可执行文件中，可执行文件中只会存储指向动态库的引用（使用了动态库的符号，以及对应库的路径）。

等程序运行的时候，动态库才会被真正加载进来。

此时，现根据记录的动态库的路径找到对应的库，再根据使用的符号从库中找到符号的真正的地址。

动态库的优点：

1. 减少可执行文件的体积，动态库在链接时不会打进去，只有在系统加载可执行文件并运行该程序的时候才会加载使用的动态库，所以可执行文件的体积会少很多
2. 代码共享，很多程序都动态地链接了这个lib，那么这个lib在内存和磁盘中只存在一份。所以动态库也被称为共享库。
3. 易于维护，由于动态库不在可执行文件中，那么当要修改动态库的时候，不需要重新编译链接生成可执行文件。

